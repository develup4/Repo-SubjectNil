//
// 파일명 : CEventStaticImage.cpp
// 
// 설명 : CEventStaticImage 클래스의 정의
//
// 김성후(lonkth@naver.com)
// 2010.01.03 최종 수정
//


#include "CEventStaticImage.h"


//////////////////////////////////////////////////////////////////////////////////////////
// CEventStaticImage(LPDIRECT3DDEVICE9 pd3dDevice, LPD3DXSPRITE sprite, LPD3DXFONT pFont)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : CEventStaticImage 클래스의 생성자.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

CEventStaticImage::CEventStaticImage(LPDIRECT3DDEVICE9 pd3dDevice, LPD3DXSPRITE sprite, LPD3DXFONT pFont) : CEventSprite(pd3dDevice, sprite, pFont)
{
	doDraw = true;
	step = 0;
}


//////////////////////////////////////////////////////////////////////////////////////////
// ~CEventStaticImage()
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : CEventStaticImage 클래스의 소멸자.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

CEventStaticImage::~CEventStaticImage()
{
	tImage->Release();
}


//////////////////////////////////////////////////////////////////////////////////////////
// void Draw()
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 본 객체의 이미지를 뿌려주는 함수.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventStaticImage::Draw()
{
	if (doDraw)
	{
		static int alpha = 0;

		sprite->Begin(D3DXSPRITE_ALPHABLEND);
		RECT rc = {0, 0, width, height};
		D3DXVECTOR3 pos((float)x, (float)y, 0);
		sprite->Draw(tImage, &rc, NULL, &pos, D3DCOLOR_RGBA(255, 255, 255, alpha));
		sprite->End();

		//오버랩효과
		alpha += 16;
		if (alpha > 255) alpha = 255;

		step++;

		//페이드아웃효과
		if (step > duration - 16) //FadeOut Time(16 * 16 = 256)
		{
			alpha -= 32;
			if (alpha < 0)
			{
				alpha = 0;
				doDraw = false;
			}
		}
	}
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetX(int val), void SetY(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 본 객체의 좌표를 설정하는 함수.
// 인자 : 인자로 받은 값만큼 각각 X좌표, Y좌표로 설정한다.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventStaticImage::SetX(int val)
{
	x = val;
}

void CEventStaticImage::SetY(int val)
{
	y = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetWidth(int val), void SetHeight(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 본 객체의 크기를 설정하는 함수.
// 인자 : 인자로 받은 값만큼 각각 가로길이, 세로길이로 설정한다.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventStaticImage::SetWidth(int val)
{
	width = val;
}

void CEventStaticImage::SetHeight(int val)
{
	height = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetDuration(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 이미지의 출력지속시간을 정하는 함수
// 인자 : int val(출력지속시간)
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventStaticImage::SetDuration(int val)
{
	duration = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetImage(char* FilePath)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 본 객체의 이미지를 설정하는 함수
// 인자 : char* FilePath(이미지의 파일경로)
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventStaticImage::SetImage(char* FilePath)
{
	D3DXCreateTextureFromFile(pd3dDevice, FilePath, &tImage);
}