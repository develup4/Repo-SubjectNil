//
// 파일명 : CEventAnimImage.cpp
// 
// 설명 : CEventAnimImage 클래스 정의
//
// 김성후(lonkth@naver.com)
// 2010.01.03 최종 수정
//


#include "CEventAnimImage.h"


////////////////////////////////////////////////////////////////////////////////////////////
// CEventAnimImage(LPDIRECT3DDEVICE9 pd3dDevice, LPD3DXSPRITE sprite, LPD3DXFONT pFont)
////////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : CEventAnimImage 클래스의 생성자.
//
// 2010.01.03 최종수정
////////////////////////////////////////////////////////////////////////////////////////////

CEventAnimImage::CEventAnimImage(LPDIRECT3DDEVICE9 pd3dDevice, LPD3DXSPRITE sprite, LPD3DXFONT pFont) : CEventSprite(pd3dDevice, sprite, pFont)
{
	doDraw = true;
	step = 0;
}


////////////////////////////////////////////////////////////////////////////////////////////
// ~CEventAnimImage()
////////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : CEventAnimImage 클래스의 소멸자.
//
// 2010.01.03 최종수정
////////////////////////////////////////////////////////////////////////////////////////////

CEventAnimImage::~CEventAnimImage()
{
	tImage->Release();
}


////////////////////////////////////////////////////////////////////////////////////////////
// void Draw()
////////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 애니메이션 이미지를 렌더링하는 함수
//
// 2010.01.03 최종수정
////////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::Draw()
{
	if (doDraw)
	{
		sprite->Begin(D3DXSPRITE_ALPHABLEND);
		RECT rc = {frameWidth * (step / animSpeed), 0, frameWidth * (step / animSpeed + 1), frameHeight};
		D3DXVECTOR3 pos((float)x, (float)y, 0);
		sprite->Draw(tImage, &rc, NULL, &pos, D3DCOLOR_RGBA(255, 255, 255, 255));
		sprite->End();
		step++;
		if (step >= numFrame * animSpeed) doDraw = false;
	}
}


////////////////////////////////////////////////////////////////////////////////////////////
// void SetX(int val), void SetY(int val)
////////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 인자로 받은 값만큼 이미지의 좌표를 설정하는 함수들
//
// 2010.01.03 최종수정
////////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::SetX(int val)
{
	x = val;
}

void CEventAnimImage::SetY(int val)
{
	y = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetFrameWidth(int val), void SetFrameHeight(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 애니메이션 프레임 하나의 크기를 설정하는 함수.
// 인자 : 인자로 받은 값만큼 각각 가로길이, 세로길이로 설정한다.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::SetFrameWidth(int val)
{
	frameWidth = val;
}

void CEventAnimImage::SetFrameHeight(int val)
{
	frameHeight = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetNumFrame(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 인자로 받은 값만큼 애니메이션 프레임의 개수를 설정하는 함수
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::SetNumFrame(int val)
{
	numFrame = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetAnimSpeed(int val)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 인자로 받은 값만큼 애니메이션 스피드를 설정하는 함수
//		  값이란 동일한 프레임이 반복되는 횟수를 의미하며,
//		  따라서 값이 작을수록 애니메이션이 빨리 진행된다.
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::SetAnimSpeed(int val)
{
	animSpeed = val;
}


//////////////////////////////////////////////////////////////////////////////////////////
// void SetImage(char* FilePath)
//////////////////////////////////////////////////////////////////////////////////////////
//
// 설명 : 본 객체의 이미지를 설정하는 함수
// 인자 : char* FilePath(이미지의 파일경로)
//
// 2010.01.03 최종수정
//////////////////////////////////////////////////////////////////////////////////////////

void CEventAnimImage::SetImage(char* FilePath)
{
	D3DXCreateTextureFromFile(pd3dDevice, FilePath, &tImage);
}